
| distributed init (rank 0): env://
number of params: 86567656
Start training for 300 epochs
Epoch: [0]  [   0/1251]  eta: 2:27:23  lr: 0.000001  loss: 7.0239 (7.0239)  time: 7.0689  data: 4.4350  max mem: 26207
Epoch: [0]  [  10/1251]  eta: 0:22:57  lr: 0.000001  loss: 7.0644 (7.0601)  time: 1.1099  data: 0.4034  max mem: 26872
Epoch: [0]  [  20/1251]  eta: 0:16:48  lr: 0.000001  loss: 7.0615 (7.0577)  time: 0.5070  data: 0.0003  max mem: 26873
Epoch: [0]  [  30/1251]  eta: 0:14:36  lr: 0.000001  loss: 7.0489 (7.0503)  time: 0.5028  data: 0.0002  max mem: 26874
Epoch: [0]  [  40/1251]  eta: 0:13:28  lr: 0.000001  loss: 7.0292 (7.0450)  time: 0.5089  data: 0.0003  max mem: 26874
Epoch: [0]  [  50/1251]  eta: 0:12:47  lr: 0.000001  loss: 7.0224 (7.0407)  time: 0.5156  data: 0.0004  max mem: 26874
Epoch: [0]  [  60/1251]  eta: 0:12:18  lr: 0.000001  loss: 7.0212 (7.0371)  time: 0.5214  data: 0.0003  max mem: 26874
Epoch: [0]  [  70/1251]  eta: 0:11:57  lr: 0.000001  loss: 7.0113 (7.0341)  time: 0.5273  data: 0.0003  max mem: 26874
Epoch: [0]  [  80/1251]  eta: 0:11:40  lr: 0.000001  loss: 7.0113 (7.0317)  time: 0.5334  data: 0.0003  max mem: 26874
Epoch: [0]  [  90/1251]  eta: 0:11:28  lr: 0.000001  loss: 7.0071 (7.0293)  time: 0.5432  data: 0.0004  max mem: 26874
Epoch: [0]  [ 100/1251]  eta: 0:11:17  lr: 0.000001  loss: 6.9995 (7.0260)  time: 0.5501  data: 0.0003  max mem: 26874
Epoch: [0]  [ 110/1251]  eta: 0:11:08  lr: 0.000001  loss: 6.9960 (7.0237)  time: 0.5533  data: 0.0002  max mem: 26874
Epoch: [0]  [ 120/1251]  eta: 0:11:00  lr: 0.000001  loss: 7.0067 (7.0221)  time: 0.5606  data: 0.0002  max mem: 26874
Epoch: [0]  [ 130/1251]  eta: 0:10:54  lr: 0.000001  loss: 6.9883 (7.0191)  time: 0.5716  data: 0.0002  max mem: 26874
Epoch: [0]  [ 140/1251]  eta: 0:10:48  lr: 0.000001  loss: 6.9843 (7.0165)  time: 0.5775  data: 0.0002  max mem: 26874
Epoch: [0]  [ 150/1251]  eta: 0:10:42  lr: 0.000001  loss: 6.9812 (7.0143)  time: 0.5795  data: 0.0003  max mem: 26874
Epoch: [0]  [ 160/1251]  eta: 0:10:36  lr: 0.000001  loss: 6.9811 (7.0129)  time: 0.5808  data: 0.0003  max mem: 26874
Epoch: [0]  [ 170/1251]  eta: 0:10:29  lr: 0.000001  loss: 6.9945 (7.0116)  time: 0.5763  data: 0.0003  max mem: 26874
Epoch: [0]  [ 180/1251]  eta: 0:10:47  lr: 0.000001  loss: 6.9914 (7.0100)  time: 0.7773  data: 0.0003  max mem: 26874
Epoch: [0]  [ 190/1251]  eta: 0:10:50  lr: 0.000001  loss: 6.9681 (7.0077)  time: 0.8737  data: 0.0003  max mem: 26874
Epoch: [0]  [ 200/1251]  eta: 0:10:46  lr: 0.000001  loss: 6.9632 (7.0054)  time: 0.7155  data: 0.0003  max mem: 26874
Epoch: [0]  [ 210/1251]  eta: 0:10:39  lr: 0.000001  loss: 6.9589 (7.0033)  time: 0.6263  data: 0.0003  max mem: 26874
Epoch: [0]  [ 220/1251]  eta: 0:10:31  lr: 0.000001  loss: 6.9660 (7.0019)  time: 0.5856  data: 0.0003  max mem: 26874
Epoch: [0]  [ 230/1251]  eta: 0:10:23  lr: 0.000001  loss: 6.9742 (7.0008)  time: 0.5772  data: 0.0003  max mem: 26874
Epoch: [0]  [ 240/1251]  eta: 0:10:15  lr: 0.000001  loss: 6.9730 (6.9993)  time: 0.5688  data: 0.0004  max mem: 26874
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x728dd5673160>
Traceback (most recent call last):
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1479, in __del__
    self._shutdown_workers()
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/utils/data/dataloader.py", line 1443, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/multiprocessing/popen_fork.py", line 44, in wait
    if not wait([self.sentinel], timeout):
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/multiprocessing/connection.py", line 931, in wait
    ready = selector.select(timeout)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt:
Traceback (most recent call last):
  File "main.py", line 863, in <module>
    main(args)
  File "main.py", line 684, in main
    train(model, criterion, optimizer, lr_scheduler, n_parameters, device, data_loader_train, data_loader_val, dataset_val, loss_scaler, model_ema, mixup_fn, output_dir)
  File "main.py", line 789, in train
    train_stats = train_one_epoch(
  File "/home/mingyuan/lab/deit/engine.py", line 47, in train_one_epoch
    outputs = model(samples)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1156, in forward
    output = self._run_ddp_forward(*inputs, **kwargs)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/nn/parallel/distributed.py", line 1110, in _run_ddp_forward
    return module_to_run(*inputs[0], **kwargs[0])  # type: ignore[index]
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/timm/models/vision_transformer.py", line 281, in forward
    x = self.forward_features(x)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/timm/models/vision_transformer.py", line 275, in forward_features
    x = blk(x)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/timm/models/vision_transformer.py", line 141, in forward
    x = x + self.drop_path(self.attn(self.norm1(x)))
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/timm/models/vision_transformer.py", line 121, in forward
    x = self.proj(x)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/mingyuan/anaconda3/envs/deit/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt