2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_setup.py:_flush():77] Current SDK version is 0.17.8
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_setup.py:_flush():77] Configure stats pid to 2259533
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_setup.py:_flush():77] Loading settings from /home/mingyuan/.config/wandb/settings
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_setup.py:_flush():77] Loading settings from /home/mingyuan/lab/deit/wandb/settings
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_setup.py:_flush():77] Loading settings from environment variables: {}
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_setup.py:_flush():77] Applying setup settings: {'_disable_service': False}
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_setup.py:_flush():77] Inferring run settings from compute environment: {'program_relpath': 'main.py', 'program_abspath': '/home/mingyuan/lab/deit/main.py', 'program': 'main.py'}
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_setup.py:_flush():77] Applying login settings: {}
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_init.py:_log_setup():524] Logging user logs to /home/mingyuan/lab/deit/wandb/run-20240904_181344-k051nf8h/logs/debug.log
2024-09-04 18:13:44,743 INFO    MainThread:2259533 [wandb_init.py:_log_setup():525] Logging internal logs to /home/mingyuan/lab/deit/wandb/run-20240904_181344-k051nf8h/logs/debug-internal.log
2024-09-04 18:13:44,744 INFO    MainThread:2259533 [wandb_init.py:init():607] calling init triggers
2024-09-04 18:13:44,744 INFO    MainThread:2259533 [wandb_init.py:init():614] wandb.init called with sweep_config: {}
config: {'batch_size': 500, 'epochs': 300, 'bce_loss': False, 'unscale_lr': False, 'model': 'deit_base_patch16_224', 'input_size': 224, 'drop': 0.0, 'drop_path': 0.1, 'model_ema': True, 'model_ema_decay': 0.99996, 'model_ema_force_cpu': False, 'opt': 'adamw', 'opt_eps': 1e-08, 'opt_betas': None, 'clip_grad': None, 'momentum': 0.9, 'weight_decay': 0.05, 'sched': 'cosine', 'lr': 0.0005, 'lr_noise': None, 'lr_noise_pct': 0.67, 'lr_noise_std': 1.0, 'warmup_lr': 1e-06, 'min_lr': 1e-05, 'decay_epochs': 30, 'warmup_epochs': 5, 'cooldown_epochs': 10, 'patience_epochs': 10, 'decay_rate': 0.1, 'color_jitter': 0.3, 'aa': 'rand-m9-mstd0.5-inc1', 'smoothing': 0.1, 'train_interpolation': 'bicubic', 'repeated_aug': True, 'train_mode': True, 'ThreeAugment': False, 'src': False, 'reprob': 0.25, 'remode': 'pixel', 'recount': 1, 'resplit': False, 'mixup': 0.8, 'cutmix': 1.0, 'cutmix_minmax': None, 'mixup_prob': 1.0, 'mixup_switch_prob': 0.5, 'mixup_mode': 'batch', 'teacher_model': 'regnety_160', 'teacher_path': '', 'distillation_type': 'none', 'distillation_alpha': 0.5, 'distillation_tau': 1.0, 'cosub': False, 'finetune': '', 'attn_only': False, 'data_path': 'data/imagenet', 'data_set': 'IMNET', 'inat_category': 'name', 'device': 'cuda', 'seed': None, 'resume': '', 'start_epoch': 0, 'eval': False, 'eval_crop_ratio': 0.875, 'dist_eval': False, 'num_workers': 10, 'pin_mem': True, 'distributed': False, 'world_size': 1, 'dist_url': 'env://', 'print_interval': 100, 'test_interval': 2000, 'plot_interval': 100000000, 'block_loss_grad': False, 'save_interval': 2000, 'stage_pr': '', 'wg': 'filter', 'method': '', 'save_init_model': True, 'base_pr_model': None, 'inherit_pruned': 'index', 'index_layer': 'numbers', 'pick_pruned': 'min', 'skip_layers': '', 'resume_path': None, 'directly_ft_weights': None, 'base_model_path': None, 'project_name': 'deit_base_patch16_224_pretrain', 'debug': False, 'screen_print': False, 'test_pretrained': False, 'verbose': False, 'batch_size_prune': 64, 'update_reg_interval': 5, 'stabilize_reg_interval': 40000, 'lr_prune': 0.0001, 'reg_upper_limit': 1.0, 'reg_upper_limit_pick': 0.01, 'reg_granularity_pick': 1e-05, 'reg_granularity_prune': 0.0001, 'reg_granularity_recover': -0.0001, 'RST_schedule': 'x', 'num_cycles': 0, 'lr_ft_mini': '', 'epochs_mini': 0, 'LTH_Iter': False, 'CodeID': '7e160fe4'}
2024-09-04 18:13:44,744 INFO    MainThread:2259533 [wandb_init.py:init():657] starting backend
2024-09-04 18:13:44,744 INFO    MainThread:2259533 [wandb_init.py:init():661] setting up manager
2024-09-04 18:13:44,744 INFO    MainThread:2259533 [backend.py:_multiprocessing_setup():105] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2024-09-04 18:13:44,745 INFO    MainThread:2259533 [wandb_init.py:init():669] backend started and connected
2024-09-04 18:13:44,747 INFO    MainThread:2259533 [wandb_init.py:init():767] updated telemetry
2024-09-04 18:13:44,762 INFO    MainThread:2259533 [wandb_init.py:init():800] communicating run to backend with 90.0 second timeout
2024-09-04 18:13:45,117 INFO    MainThread:2259533 [wandb_init.py:init():851] starting run threads in backend
2024-09-04 18:13:46,305 INFO    MainThread:2259533 [wandb_run.py:_console_start():2463] atexit reg
2024-09-04 18:13:46,305 INFO    MainThread:2259533 [wandb_run.py:_redirect():2309] redirect: wrap_raw
2024-09-04 18:13:46,305 INFO    MainThread:2259533 [wandb_run.py:_redirect():2374] Wrapping output streams.
2024-09-04 18:13:46,305 INFO    MainThread:2259533 [wandb_run.py:_redirect():2399] Redirects installed.
2024-09-04 18:13:46,306 INFO    MainThread:2259533 [wandb_init.py:init():894] run started, returning control to user process
2024-09-04 18:13:46,307 INFO    MainThread:2259533 [wandb_run.py:_config_callback():1392] config_cb None None {'batch_size': 500, 'epochs': 300, 'bce_loss': False, 'unscale_lr': False, 'model': 'deit_base_patch16_224', 'input_size': 224, 'drop': 0.0, 'drop_path': 0.1, 'model_ema': True, 'model_ema_decay': 0.99996, 'model_ema_force_cpu': False, 'opt': 'adamw', 'opt_eps': 1e-08, 'opt_betas': None, 'clip_grad': None, 'momentum': 0.9, 'weight_decay': 0.05, 'sched': 'cosine', 'lr': 0.0005, 'lr_noise': None, 'lr_noise_pct': 0.67, 'lr_noise_std': 1.0, 'warmup_lr': 1e-06, 'min_lr': 1e-05, 'decay_epochs': 30, 'warmup_epochs': 5, 'cooldown_epochs': 10, 'patience_epochs': 10, 'decay_rate': 0.1, 'color_jitter': 0.3, 'aa': 'rand-m9-mstd0.5-inc1', 'smoothing': 0.1, 'train_interpolation': 'bicubic', 'repeated_aug': True, 'train_mode': True, 'ThreeAugment': False, 'src': False, 'reprob': 0.25, 'remode': 'pixel', 'recount': 1, 'resplit': False, 'mixup': 0.8, 'cutmix': 1.0, 'cutmix_minmax': None, 'mixup_prob': 1.0, 'mixup_switch_prob': 0.5, 'mixup_mode': 'batch', 'teacher_model': 'regnety_160', 'teacher_path': '', 'distillation_type': 'none', 'distillation_alpha': 0.5, 'distillation_tau': 1.0, 'cosub': False, 'finetune': '', 'attn_only': False, 'data_path': 'data/imagenet', 'data_set': 'IMNET', 'inat_category': 'name', 'device': 'cuda', 'seed': None, 'resume': '', 'start_epoch': 0, 'eval': False, 'eval_crop_ratio': 0.875, 'dist_eval': False, 'num_workers': 10, 'pin_mem': True, 'distributed': False, 'world_size': 1, 'dist_url': 'env://', 'print_interval': 100, 'test_interval': 2000, 'plot_interval': 100000000, 'block_loss_grad': False, 'save_interval': 2000, 'stage_pr': '', 'wg': 'filter', 'method': '', 'save_init_model': True, 'base_pr_model': None, 'inherit_pruned': 'index', 'index_layer': 'numbers', 'pick_pruned': 'min', 'skip_layers': '', 'resume_path': None, 'directly_ft_weights': None, 'base_model_path': None, 'project_name': 'deit_base_patch16_224_pretrain', 'debug': False, 'screen_print': False, 'test_pretrained': False, 'verbose': False, 'batch_size_prune': 64, 'update_reg_interval': 5, 'stabilize_reg_interval': 40000, 'lr_prune': 0.0001, 'reg_upper_limit': 1.0, 'reg_upper_limit_pick': 0.01, 'reg_granularity_pick': 1e-05, 'reg_granularity_prune': 0.0001, 'reg_granularity_recover': -0.0001, 'RST_schedule': 'x', 'num_cycles': 0, 'lr_ft_mini': '', 'epochs_mini': 0, 'LTH_Iter': False, 'CodeID': '7e160fe4'}
2024-09-04 18:14:07,770 WARNING MsgRouterThr:2259533 [router.py:message_loop():77] message_loop has been closed
